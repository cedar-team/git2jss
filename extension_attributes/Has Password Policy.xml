<?xml version="1.0" encoding="UTF-8"?><extensionAttribute>
<displayName>Has Password Policy</displayName>
<description>Checks to see whether the computer has a password policy set</description>
<dataType>string</dataType>
<scriptContentsMac>#!/bin/sh&#13;
# This script checks if the existing pwpolicy (or non-existent pwpolicy) matches the pwpolicy by looking to see if&#13;
# the string &lt;string&gt;Does not match any of last 5 passwords&lt;/string&gt; exists in the current computer's pwpolicy&#13;
&#13;
# get logged-in user and assign it to a variable&#13;
LOGGEDINUSER=`who -q | head -1 | cut -d ' ' -f1`&#13;
if [ "$LOGGEDINUSER" == "_mbsetupuser" ]; then&#13;
    LOGGEDINUSER=`who -q | head -1 | cut -d ' ' -f2`&#13;
fi&#13;
&#13;
CURRENTPWPOLICY=`pwpolicy -getaccountpolicies | grep 'Not be the same as the previous 6 passwords.' | head -1 | sed -e 's/  //g' `&#13;
PWPOLICY="&lt;string&gt;Not be the same as the previous 6 passwords.&lt;/string&gt;"&#13;
if [ "$CURRENTPWPOLICY" == "$PWPOLICY" ]; then&#13;
    echo "&lt;result&gt;$LOGGEDINUSER has the password policy&lt;/result&gt;"&#13;
else&#13;
    echo "&lt;result&gt;$LOGGEDINUSER DOES NOT have the password policy&lt;/result&gt;"&#13;
fi&#13;
exit 0&#13;
</scriptContentsMac>
</extensionAttribute>
