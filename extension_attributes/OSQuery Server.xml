<?xml version="1.0" encoding="UTF-8"?><extensionAttribute>
<displayName>OSQuery Server</displayName>
<description/>
<dataType>string</dataType>
<scriptContentsMac>#!/bin/bash&#13;
&#13;
###&#13;
#&#13;
#            Name:  Osquery Server.sh&#13;
#     Description:  Returns tls_hostname attribute from osquery.flags (if present).&#13;
#         Created:  2017-09-07&#13;
#   Last Modified:  2018-06-20&#13;
#         Version:  1.0.2&#13;
#&#13;
#&#13;
# Copyright 2017 Palantir Technologies, Inc.&#13;
#&#13;
# Licensed under the Apache License, Version 2.0 (the "License");&#13;
# you may not use this file except in compliance with the License.&#13;
# You may obtain a copy of the License at&#13;
#&#13;
# http://www.apache.org/licenses/LICENSE-2.0&#13;
#&#13;
# Unless required by applicable law or agreed to in writing, software&#13;
# distributed under the License is distributed on an "AS IS" BASIS,&#13;
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&#13;
# See the License for the specific language governing permissions and&#13;
# limitations under the License.&#13;
#&#13;
#&#13;
###&#13;
&#13;
&#13;
&#13;
########## variable-ing ##########&#13;
&#13;
&#13;
&#13;
osqueryFlagsPath="/var/osquery/osquery.flags"&#13;
&#13;
&#13;
&#13;
########## main process ##########&#13;
&#13;
&#13;
&#13;
if [[ -e "$osqueryFlagsPath" ]]; then&#13;
  osqueryServer=$("/bin/cat" "$osqueryFlagsPath" | "/usr/bin/awk" -F= '/tls_hostname/ {print $2}')&#13;
else&#13;
  osqueryServer=""&#13;
fi&#13;
&#13;
&#13;
"/bin/echo" "&lt;result&gt;$osqueryServer&lt;/result&gt;"&#13;
&#13;
&#13;
&#13;
exit 0</scriptContentsMac>
</extensionAttribute>
